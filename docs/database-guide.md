# Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø§Ù…ÛŒØ±

Ø§ÛŒÙ† Ø±Ø§Ù‡Ù†Ù…Ø§ Ø³Ø§Ø®ØªØ§Ø± Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡ØŒ Ø±ÙˆØ§Ø¨Ø· Ø¨ÛŒÙ† Ø¬Ø¯Ø§ÙˆÙ„ Ùˆ Ù†Ú©Ø§Øª Ù…Ù‡Ù… Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø± Ø¨Ø§ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø§Ù…ÛŒØ± Ø±Ø§ ØªÙˆØ¶ÛŒØ­ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯.

## ğŸ—ƒï¸ Ø³Ø§Ø®ØªØ§Ø± Ú©Ù„ÛŒ Ø¯ÛŒØªØ§Ø¨ÛŒØ³

Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡ Ø§Ù…ÛŒØ± Ø¨Ø± Ø§Ø³Ø§Ø³ Ø§ØµÙˆÙ„ Ø­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ Ùˆ Ù†ÛŒØ§Ø²Ù‡Ø§ÛŒ Ø³ÛŒØ³ØªÙ…â€ŒÙ‡Ø§ÛŒ Ù…Ø§Ù„ÛŒ Ø·Ø±Ø§Ø­ÛŒ Ø´Ø¯Ù‡ Ø§Ø³Øª.

### Ø¬Ø¯Ø§ÙˆÙ„ Ø§ØµÙ„ÛŒ

```
Ø§Ù…ÛŒØ± Ø¯ÛŒØªØ§Ø¨ÛŒØ³
â”œâ”€â”€ ğŸ‘¥ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†
â”‚   â”œâ”€â”€ users                 # Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø³ÛŒØ³ØªÙ…
â”‚   â”œâ”€â”€ roles                 # Ù†Ù‚Ø´â€ŒÙ‡Ø§
â”‚   â”œâ”€â”€ permissions           # Ù…Ø¬ÙˆØ²Ù‡Ø§
â”‚   â””â”€â”€ model_has_permissions # Ø§Ø±ØªØ¨Ø§Ø· Ú©Ø§Ø±Ø¨Ø±-Ù…Ø¬ÙˆØ²
â”œâ”€â”€ ğŸ¢ Ù…Ø¯ÛŒØ±ÛŒØª Ø´Ø±Ú©Øªâ€ŒÙ‡Ø§
â”‚   â”œâ”€â”€ companies             # Ø´Ø±Ú©Øªâ€ŒÙ‡Ø§
â”‚   â”œâ”€â”€ fiscal_years          # Ø³Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ù…Ø§Ù„ÛŒ
â”‚   â””â”€â”€ configs               # ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø´Ø±Ú©Øª
â”œâ”€â”€ ğŸ“Š Ù‡Ø³ØªÙ‡ Ø­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ
â”‚   â”œâ”€â”€ subjects              # Ø³Ø±ÙØµÙ„â€ŒÙ‡Ø§ÛŒ Ø­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ
â”‚   â”œâ”€â”€ documents             # Ø§Ø³Ù†Ø§Ø¯ Ø­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ
â”‚   â””â”€â”€ transactions          # ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ÛŒ Ù…Ø§Ù„ÛŒ
â”œâ”€â”€ ğŸ‘¤ Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø´ØªØ±ÛŒØ§Ù†
â”‚   â”œâ”€â”€ customers             # Ù…Ø´ØªØ±ÛŒØ§Ù†
â”‚   â””â”€â”€ customer_groups       # Ú¯Ø±ÙˆÙ‡â€ŒÙ‡Ø§ÛŒ Ù…Ø´ØªØ±ÛŒ
â”œâ”€â”€ ğŸ“¦ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø§Ù„Ø§
â”‚   â”œâ”€â”€ products              # Ú©Ø§Ù„Ø§Ù‡Ø§
â”‚   â””â”€â”€ product_groups        # Ú¯Ø±ÙˆÙ‡â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ù„Ø§
â”œâ”€â”€ ğŸ§¾ ÙØ§Ú©ØªÙˆØ±Ù‡Ø§
â”‚   â”œâ”€â”€ invoices              # ÙØ§Ú©ØªÙˆØ±Ù‡Ø§
â”‚   â””â”€â”€ invoice_items         # Ø§Ù‚Ù„Ø§Ù… ÙØ§Ú©ØªÙˆØ±
â”œâ”€â”€ ğŸ¦ Ù…Ø¯ÛŒØ±ÛŒØª Ø¨Ø§Ù†Ú©
â”‚   â”œâ”€â”€ banks                 # Ø¨Ø§Ù†Ú©â€ŒÙ‡Ø§
â”‚   â”œâ”€â”€ bank_accounts         # Ø­Ø³Ø§Ø¨â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ù†Ú©ÛŒ
â”‚   â”œâ”€â”€ cheques               # Ú†Ú©â€ŒÙ‡Ø§
â”‚   â””â”€â”€ cheque_histories      # ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ú†Ú©â€ŒÙ‡Ø§
â””â”€â”€ ğŸ’° Ù¾Ø±Ø¯Ø§Ø®Øªâ€ŒÙ‡Ø§
    â””â”€â”€ payments              # Ù¾Ø±Ø¯Ø§Ø®Øªâ€ŒÙ‡Ø§
```

## ğŸ”— Ø±ÙˆØ§Ø¨Ø· Ø¨ÛŒÙ† Ø¬Ø¯Ø§ÙˆÙ„

### Ù†Ù…ÙˆØ¯Ø§Ø± ERD Ø³Ø§Ø¯Ù‡â€ŒØ´Ø¯Ù‡

```
companies (1) â”€â”€â†’ (N) fiscal_years
    â”‚
    â”œâ”€â†’ (N) subjects
    â”œâ”€â†’ (N) customers
    â”œâ”€â†’ (N) products
    â””â”€â†’ (N) documents
            â”‚
            â””â”€â†’ (N) transactions â”€â”€â†’ subjects

users (N) â†â”€â”€â†’ (N) roles â†â”€â”€â†’ (N) permissions

invoices (1) â”€â”€â†’ (N) invoice_items
    â”‚
    â””â”€â†’ documents

customers â”€â”€â†’ subjects (Ø­Ø³Ø§Ø¨ Ø¯Ø±ÛŒØ§ÙØªÙ†ÛŒ)
products â”€â”€â†’ subjects (Ø­Ø³Ø§Ø¨ Ù…ÙˆØ¬ÙˆØ¯ÛŒ)
```

## ğŸ“‹ ØªÙˆØ¶ÛŒØ­ Ø¬Ø¯Ø§ÙˆÙ„ Ø§ØµÙ„ÛŒ

### ğŸ¢ Ø¬Ø¯ÙˆÙ„ `companies` - Ø´Ø±Ú©Øªâ€ŒÙ‡Ø§

```sql
CREATE TABLE companies (
    id BIGINT PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    logo VARCHAR(255) NULL,
    address TEXT NULL,
    economical_code VARCHAR(15) NULL,
    national_code VARCHAR(12) NULL,
    postal_code VARCHAR(10) NULL,
    phone_number VARCHAR(15) NULL,
    created_at TIMESTAMP,
    updated_at TIMESTAMP
);
```

**Ù†Ú©Ø§Øª Ù…Ù‡Ù…:**
- Ù‡Ø± Ø´Ø±Ú©Øª Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒØ§ÛŒ Ù…Ø³ØªÙ‚Ù„ Ø§Ø² Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¯Ø§Ø±Ø¯
- Ø¬Ø¯Ø§Ø³Ø§Ø²ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ `company_id` Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ´ÙˆØ¯
- ÛŒÚ© Ú©Ø§Ø±Ø¨Ø± Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø¨Ù‡ Ú†Ù†Ø¯ Ø´Ø±Ú©Øª Ø¯Ø³ØªØ±Ø³ÛŒ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯

### ğŸ“… Ø¬Ø¯ÙˆÙ„ `fiscal_years` - Ø³Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ù…Ø§Ù„ÛŒ

```sql
CREATE TABLE fiscal_years (
    id BIGINT PRIMARY KEY,
    title VARCHAR(255) NOT NULL,
    start_date DATE NOT NULL,
    end_date DATE NOT NULL,
    is_closed BOOLEAN DEFAULT FALSE,
    company_id BIGINT NOT NULL,
    created_at TIMESTAMP,
    updated_at TIMESTAMP,
    
    FOREIGN KEY (company_id) REFERENCES companies(id)
);
```

**Ù†Ú©Ø§Øª Ù…Ù‡Ù…:**
- Ù‡Ø± Ø´Ø±Ú©Øª Ú†Ù†Ø¯ÛŒÙ† Ø³Ø§Ù„ Ù…Ø§Ù„ÛŒ Ø¯Ø§Ø±Ø¯
- ØªÙ…Ø§Ù… Ø§Ø³Ù†Ø§Ø¯ Ùˆ ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ Ø¨Ù‡ Ø³Ø§Ù„ Ù…Ø§Ù„ÛŒ Ù…Ø´Ø®ØµÛŒ ØªØ¹Ù„Ù‚ Ø¯Ø§Ø±Ù†Ø¯
- Ø§Ù…Ú©Ø§Ù† Ú©Ù„ÙˆÙ† Ú©Ø±Ø¯Ù† Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨ÛŒÙ† Ø³Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ù…Ø§Ù„ÛŒ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯

### ğŸ“Š Ø¬Ø¯ÙˆÙ„ `subjects` - Ø³Ø±ÙØµÙ„â€ŒÙ‡Ø§ÛŒ Ø­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ

```sql
CREATE TABLE subjects (
    id BIGINT PRIMARY KEY,
    code VARCHAR(20) NOT NULL,
    name VARCHAR(60) NOT NULL,
    parent_id BIGINT NULL,
    type ENUM('debtor', 'creditor', 'both') DEFAULT 'both',
    company_id BIGINT NOT NULL,
    subjectable_type VARCHAR(255) NULL, -- Polymorphic
    subjectable_id BIGINT NULL,         -- Polymorphic
    created_at TIMESTAMP,
    updated_at TIMESTAMP,
    
    FOREIGN KEY (parent_id) REFERENCES subjects(id) ON DELETE CASCADE,
    FOREIGN KEY (company_id) REFERENCES companies(id) ON DELETE CASCADE,
    UNIQUE KEY unique_company_code (company_id, code)
);
```

**Ù†Ú©Ø§Øª Ù…Ù‡Ù…:**
- Ø³Ø§Ø®ØªØ§Ø± Ø¯Ø±Ø®ØªÛŒ (Tree Structure) Ø¨Ø§ `parent_id`
- Ú©Ø¯ÛŒÙ†Ú¯ Ù…Ù†Ø­ØµØ±Ø¨Ù‡â€ŒÙØ±Ø¯ Ø¯Ø± Ù‡Ø± Ø´Ø±Ú©Øª
- Ø§Ø±ØªØ¨Ø§Ø· Polymorphic Ø¨Ø§ Ø³Ø§ÛŒØ± entities (Ù…Ø´ØªØ±ÛŒØŒ Ú©Ø§Ù„Ø§ØŒ Ùˆ...)
- Ø§Ù†ÙˆØ§Ø¹: `debtor` (Ø¨Ø¯Ù‡Ú©Ø§Ø±)ØŒ `creditor` (Ø¨Ø³ØªØ§Ù†Ú©Ø§Ø±)ØŒ `both` (Ù‡Ø±Ø¯Ùˆ)

**Ù…Ø«Ø§Ù„ Ø³Ø§Ø®ØªØ§Ø± Ø³Ø±ÙØµÙ„:**
```
1. Ø¯Ø§Ø±Ø§ÛŒÛŒâ€ŒÙ‡Ø§
   1.1 Ø¯Ø§Ø±Ø§ÛŒÛŒâ€ŒÙ‡Ø§ÛŒ Ø¬Ø§Ø±ÛŒ
       1.1.1 Ù†Ù‚Ø¯ Ùˆ Ø¨Ø§Ù†Ú©
             1.1.1.001 ØµÙ†Ø¯ÙˆÙ‚
             1.1.1.002 Ø¨Ø§Ù†Ú© Ù…Ù„Øª
   1.2 Ø¯Ø§Ø±Ø§ÛŒÛŒâ€ŒÙ‡Ø§ÛŒ Ø«Ø§Ø¨Øª
       1.2.1 Ø³Ø§Ø®ØªÙ…Ø§Ù†
```

### ğŸ“„ Ø¬Ø¯ÙˆÙ„ `documents` - Ø§Ø³Ù†Ø§Ø¯ Ø­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ

```sql
CREATE TABLE documents (
    id BIGINT PRIMARY KEY,
    number DECIMAL(16,2) NULL,
    title VARCHAR(255) NULL,
    date DATE NULL,
    approved_at DATE NULL,
    creator_id BIGINT NULL,
    approver_id BIGINT NULL,
    company_id BIGINT NULL,
    created_at TIMESTAMP,
    updated_at TIMESTAMP,
    
    FOREIGN KEY (creator_id) REFERENCES users(id) ON DELETE SET NULL,
    FOREIGN KEY (approver_id) REFERENCES users(id) ON DELETE SET NULL,
    FOREIGN KEY (company_id) REFERENCES companies(id) ON DELETE SET NULL
);
```

**Ù†Ú©Ø§Øª Ù…Ù‡Ù…:**
- Ø´Ù…Ø§Ø±Ù‡ Ø³Ù†Ø¯ (`number`) Ø¯Ø± Ù‡Ø± Ø³Ø§Ù„ Ù…Ø§Ù„ÛŒ ÛŒÚ©ØªØ§ Ø§Ø³Øª
- Ù‡Ø± Ø³Ù†Ø¯ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ú†Ù†Ø¯ÛŒÙ† ØªØ±Ø§Ú©Ù†Ø´ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯
- Ø§Ù…Ú©Ø§Ù† ØªØ£ÛŒÛŒØ¯ Ø³Ù†Ø¯ ØªÙˆØ³Ø· Ú©Ø§Ø±Ø¨Ø± Ù…Ø¬Ø§Ø²
- Ø±Ø¯Ú¯ÛŒØ±ÛŒ Ú©Ø§Ø±Ø¨Ø± Ø§ÛŒØ¬Ø§Ø¯Ú©Ù†Ù†Ø¯Ù‡

### ğŸ’± Ø¬Ø¯ÙˆÙ„ `transactions` - ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ÛŒ Ù…Ø§Ù„ÛŒ

```sql
CREATE TABLE transactions (
    id BIGINT PRIMARY KEY,
    subject_id BIGINT NULL,
    document_id BIGINT NULL,
    user_id BIGINT NULL,
    desc VARCHAR(255) NULL,
    value DECIMAL(14,2) NOT NULL,
    created_at TIMESTAMP,
    updated_at TIMESTAMP,
    
    FOREIGN KEY (subject_id) REFERENCES subjects(id) ON DELETE SET NULL,
    FOREIGN KEY (document_id) REFERENCES documents(id) ON DELETE SET NULL,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE SET NULL
);
```

**Ù†Ú©Ø§Øª Ù…Ù‡Ù…:**
- `value` Ù…Ø«Ø¨Øª = Ø¨Ø³ØªØ§Ù†Ú©Ø§Ø±ØŒ Ù…Ù†ÙÛŒ = Ø¨Ø¯Ù‡Ú©Ø§Ø± (Ù…Ø·Ø§Ø¨Ù‚ Ù…Ù†Ø·Ù‚ Â«Ø¨Ø³ØªØ§Ù†Ú©Ø§Ø± - Ø¨Ø¯Ù‡Ú©Ø§Ø±Â» Ø¯Ø± Ø³Ø±ÙˆÛŒØ³ Ø§Ø³Ù†Ø§Ø¯)
- Ù‡Ø± ØªØ±Ø§Ú©Ù†Ø´ Ø¨Ù‡ ÛŒÚ© Ø³Ø±ÙØµÙ„ Ùˆ Ø³Ù†Ø¯ ØªØ¹Ù„Ù‚ Ø¯Ø§Ø±Ø¯
- Ù…Ø¬Ù…ÙˆØ¹ `value` Ø¯Ø± Ù‡Ø± Ø³Ù†Ø¯ Ø¨Ø§ÛŒØ¯ ØµÙØ± Ø¨Ø§Ø´Ø¯ (Ù…ÙˆØ§Ø²Ù†Ù‡)

**Ù…Ø«Ø§Ù„ ØªØ±Ø§Ú©Ù†Ø´ ÙØ±ÙˆØ´:**
```sql
-- Ø³Ù†Ø¯ ÙØ±ÙˆØ´ 100,000 ØªÙˆÙ…Ø§Ù† Ù†Ù‚Ø¯ÛŒ
INSERT INTO transactions VALUES
(1, 'cash_account_id', 'document_id', 'user_id', 'Ø¯Ø±ÛŒØ§ÙØª Ù†Ù‚Ø¯', -100000),
(2, 'sales_account_id', 'document_id', 'user_id', 'ÙØ±ÙˆØ´ Ú©Ø§Ù„Ø§', 100000);
-- Ù…Ø¬Ù…ÙˆØ¹: -100000 + 100000 = 0 âœ“
```

### ğŸ‘¤ Ø¬Ø¯ÙˆÙ„ `customers` - Ù…Ø´ØªØ±ÛŒØ§Ù†

```sql
CREATE TABLE customers (
    id BIGINT UNSIGNED PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    subject_id BIGINT UNSIGNED NULL,
    phone VARCHAR(15) NULL DEFAULT '',
    cell VARCHAR(15) NULL DEFAULT '',
    fax VARCHAR(15) NULL DEFAULT '',
    address VARCHAR(100) NULL DEFAULT '',
    postal_code VARCHAR(15) NULL DEFAULT '',
    email VARCHAR(64) NULL DEFAULT '',
    ecnmcs_code VARCHAR(20) NULL DEFAULT '',
    personal_code VARCHAR(15) NULL DEFAULT '',
    web_page VARCHAR(50) NULL DEFAULT '',
    responsible VARCHAR(50) NULL DEFAULT '',
    connector VARCHAR(50) NULL DEFAULT '',
    group_id BIGINT UNSIGNED NULL,
    desc TEXT NULL,
    balance DECIMAL(10,2) NULL DEFAULT 0,
    credit DECIMAL(10,2) NULL DEFAULT 0,
    rep_via_email BOOLEAN NULL DEFAULT FALSE,
    acc_name_1 VARCHAR(50) NULL DEFAULT '',
    acc_no_1 VARCHAR(30) NULL DEFAULT '',
    acc_bank_1 VARCHAR(50) NULL DEFAULT '',
    acc_name_2 VARCHAR(50) NULL DEFAULT '',
    acc_no_2 VARCHAR(30) NULL DEFAULT '',
    acc_bank_2 VARCHAR(50) NULL DEFAULT '',
    type_buyer BOOLEAN NOT NULL DEFAULT FALSE,
    type_seller BOOLEAN NOT NULL DEFAULT FALSE,
    type_mate BOOLEAN NOT NULL DEFAULT FALSE,
    type_agent BOOLEAN NOT NULL DEFAULT FALSE,
    introducer_id BIGINT UNSIGNED NULL,
    commission VARCHAR(15) NOT NULL DEFAULT '0',
    marked BOOLEAN NOT NULL DEFAULT FALSE,
    reason VARCHAR(200) NULL DEFAULT '',
    disc_rate VARCHAR(15) NOT NULL DEFAULT '0',
    created_at TIMESTAMP NULL,
    updated_at TIMESTAMP NULL,
    company_id BIGINT UNSIGNED NOT NULL,

    FOREIGN KEY (subject_id) REFERENCES subjects(id) ON DELETE SET NULL,
    FOREIGN KEY (group_id) REFERENCES customer_groups(id) ON DELETE SET NULL,
    FOREIGN KEY (introducer_id) REFERENCES customers(id) ON DELETE SET NULL,
    FOREIGN KEY (company_id) REFERENCES companies(id) ON DELETE CASCADE
);
```

**Ù†Ú©Ø§Øª Ù…Ù‡Ù…:**
- Ù‡Ø± Ù…Ø´ØªØ±ÛŒ Ø¨Ù‡ ÛŒÚ© Ø³Ø±ÙØµÙ„ "Ø­Ø³Ø§Ø¨â€ŒÙ‡Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØªÙ†ÛŒ" Ù…ØªØµÙ„ Ø§Ø³Øª
- Ø§Ù…Ú©Ø§Ù† Ú¯Ø±ÙˆÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ù…Ø´ØªØ±ÛŒØ§Ù†
- Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªÙ…Ø§Ø³ Ú©Ø§Ù…Ù„ + ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù…Ø§Ù„ÛŒ (Ø³Ù‚Ù Ø§Ø¹ØªØ¨Ø§Ø±ØŒ Ù…Ø§Ù†Ø¯Ù‡ Ø§ÙˆÙ„ÛŒÙ‡ Ùˆ Ù¾Ø±Ú†Ù…â€ŒÙ‡Ø§ÛŒ Ù†Ù‚Ø´ Ø®Ø±ÛŒØ¯Ø§Ø±/ÙØ±ÙˆØ´Ù†Ø¯Ù‡ Ùˆ ...)

### ğŸ“¦ Ø¬Ø¯ÙˆÙ„ `products` - Ú©Ø§Ù„Ø§Ù‡Ø§

```sql
CREATE TABLE products (
    id BIGINT UNSIGNED PRIMARY KEY,
    code VARCHAR(20) NOT NULL,
    name VARCHAR(60) NOT NULL,
    `group` BIGINT UNSIGNED NULL,
    location VARCHAR(50) NULL,
    quantity FLOAT NOT NULL,
    quantity_warning FLOAT NULL,
    oversell BOOLEAN NOT NULL DEFAULT FALSE,
    purchace_price DECIMAL(10,2) NOT NULL,
    selling_price DECIMAL(10,2) NOT NULL,
    discount_formula VARCHAR(100) NULL,
    description VARCHAR(200) NULL,
    company_id BIGINT UNSIGNED NOT NULL,

    FOREIGN KEY (`group`) REFERENCES product_groups(id) ON DELETE SET NULL,
    FOREIGN KEY (company_id) REFERENCES companies(id) ON DELETE CASCADE,
    UNIQUE KEY unique_company_product_code (company_id, code)
);
```

**Ù†Ú©Ø§Øª Ù…Ù‡Ù…:**
- Ú©Ø¯ Ú©Ø§Ù„Ø§ Ø¯Ø± Ø³Ø·Ø­ Ù‡Ø± Ø´Ø±Ú©Øª ÛŒÚ©ØªØ§ Ø§Ø³Øª (Ø§ÛŒÙ†Ø¯Ú©Ø³ ØªØ±Ú©ÛŒØ¨ÛŒ `company_id + code`).
- Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ÛŒ `quantity` Ùˆ `quantity_warning` Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ùˆ Ù‡Ø´Ø¯Ø§Ø± Ú©Ù…Ø¨ÙˆØ¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ Ùˆ `oversell` Ø§Ù…Ú©Ø§Ù† ÙØ±ÙˆØ´ Ø¨ÛŒØ´ Ø§Ø² Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø±Ø§ Ú©Ù†ØªØ±Ù„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.

### ğŸ§¾ Ø¬Ø¯ÙˆÙ„ `invoices` - ÙØ§Ú©ØªÙˆØ±Ù‡Ø§

```sql
CREATE TABLE invoices (
    id BIGINT UNSIGNED PRIMARY KEY,
    number VARCHAR(255) NOT NULL,
    date DATE NOT NULL,
    creator_id BIGINT UNSIGNED NULL,
    approver_id BIGINT UNSIGNED NULL,
    document_id BIGINT UNSIGNED NULL,
    company_id BIGINT UNSIGNED NULL,
    customer_id BIGINT UNSIGNED NOT NULL,
    addition DECIMAL(16,2) NOT NULL,
    subtraction DECIMAL(16,2) NOT NULL,
    vat DECIMAL(16,2) NOT NULL,
    cash_payment DECIMAL(16,2) NOT NULL,
    ship_date DATE NULL,
    ship_via VARCHAR(100) NULL,
    description TEXT NULL,
    is_sell BOOLEAN NOT NULL,
    active BOOLEAN NOT NULL DEFAULT FALSE,
    amount DECIMAL(18,2) NOT NULL DEFAULT 0,
    created_at TIMESTAMP NULL,
    updated_at TIMESTAMP NULL,

    UNIQUE KEY invoices_number_unique (number),
    FOREIGN KEY (creator_id) REFERENCES users(id) ON DELETE SET NULL,
    FOREIGN KEY (approver_id) REFERENCES users(id) ON DELETE SET NULL,
    FOREIGN KEY (document_id) REFERENCES documents(id) ON DELETE SET NULL,
    FOREIGN KEY (company_id) REFERENCES documents(id) ON DELETE SET NULL,
    FOREIGN KEY (customer_id) REFERENCES customers(id) ON DELETE CASCADE
);
```

**Ù†Ú©Ø§Øª Ù…Ù‡Ù…:**
- ÙÛŒÙ„Ø¯ `number` Ø¨Ø±Ø§ÛŒ Ù‡Ø± ÙØ§Ú©ØªÙˆØ± ÛŒÚ©ØªØ§ Ø§Ø³Øª.
- Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ÛŒ `addition`ØŒ `subtraction`ØŒ `vat` Ùˆ `cash_payment` Ø¨Ø±Ø§ÛŒ Ø¬Ù…Ø¹ Ù…Ø¨Ø§Ù„Øº Ø¬Ø§Ù†Ø¨ÛŒ Ùˆ Ù¾Ø±Ø¯Ø§Ø®Øª Ù†Ù‚Ø¯ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯.
- Ø¯Ø± Ø§Ø³Ú©ÛŒÙ…Ø§ ÙØ¹Ù„ÛŒØŒ Ú©Ù„ÛŒØ¯ Ø®Ø§Ø±Ø¬ÛŒ `company_id` Ø¨Ù‡ Ø¬Ø¯ÙˆÙ„ `documents` Ù…ØªØµÙ„ Ø´Ø¯Ù‡ Ø§Ø³Øª (Ø¯Ø± ØµÙˆØ±Øª Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø§Ø±Ø¬Ø§Ø¹ Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ Ø´Ø±Ú©Øª Ø¨Ø§ÛŒØ¯ Ø¯Ø± Ù…Ø§ÛŒÚ¯Ø±ÛŒØ´Ù† Ø§ØµÙ„Ø§Ø­ Ø´ÙˆØ¯).

### ğŸ“ Ø¬Ø¯ÙˆÙ„ `invoice_items` - Ø§Ù‚Ù„Ø§Ù… ÙØ§Ú©ØªÙˆØ±

```sql
CREATE TABLE invoice_items (
    id BIGINT UNSIGNED PRIMARY KEY,
    invoice_id BIGINT UNSIGNED NULL,
    product_id BIGINT UNSIGNED NULL,
    transaction_id BIGINT UNSIGNED NULL,
    quantity DECIMAL(10,2) NOT NULL,
    unit_price DECIMAL(10,2) NOT NULL,
    unit_discount DECIMAL(10,2) NOT NULL,
    vat DECIMAL(10,2) NOT NULL,
    amount DECIMAL(10,2) NOT NULL,
    description TEXT NULL,
    created_at TIMESTAMP NULL,
    updated_at TIMESTAMP NULL,

    FOREIGN KEY (invoice_id) REFERENCES invoices(id) ON DELETE SET NULL,
    FOREIGN KEY (product_id) REFERENCES products(id) ON DELETE SET NULL,
    FOREIGN KEY (transaction_id) REFERENCES transactions(id) ON DELETE SET NULL
);
```

## ğŸ” Ø¬Ø¯Ø§ÙˆÙ„ Ù…Ø¯ÛŒØ±ÛŒØª Ø¯Ø³ØªØ±Ø³ÛŒ

### Ø¬Ø¯ÙˆÙ„ `users` - Ú©Ø§Ø±Ø¨Ø±Ø§Ù†

```sql
CREATE TABLE users (
    id BIGINT PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    email_verified_at TIMESTAMP NULL,
    password VARCHAR(255) NOT NULL,
    remember_token VARCHAR(100) NULL,
    created_at TIMESTAMP,
    updated_at TIMESTAMP
);
```

### Ø³ÛŒØ³ØªÙ… Ù†Ù‚Ø´â€ŒÙ‡Ø§ Ùˆ Ù…Ø¬ÙˆØ²Ù‡Ø§ (Spatie Permission)

```sql
CREATE TABLE roles (
    id BIGINT PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    guard_name VARCHAR(255) NOT NULL,
    created_at TIMESTAMP,
    updated_at TIMESTAMP
);

-- Ù…Ø¬ÙˆØ²Ù‡Ø§
CREATE TABLE permissions (
    id BIGINT PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    guard_name VARCHAR(255) NOT NULL,
    created_at TIMESTAMP,
    updated_at TIMESTAMP
);

-- Ø§Ø®ØªØµØ§Øµ Ù†Ù‚Ø´ Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±
CREATE TABLE model_has_roles (
    role_id BIGINT NOT NULL,
    model_type VARCHAR(255) NOT NULL,
    model_id BIGINT NOT NULL,
    
    PRIMARY KEY (role_id, model_id, model_type)
);
```

## ğŸ—‚ï¸ Ø§ÛŒÙ†Ø¯Ú©Ø³â€ŒÙ‡Ø§ Ùˆ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ

### Ø§ÛŒÙ†Ø¯Ú©Ø³â€ŒÙ‡Ø§ÛŒ Ù…Ù‡Ù…

```sql
CREATE INDEX idx_transactions_subject_date ON transactions(subject_id, created_at);
CREATE INDEX idx_transactions_document ON transactions(document_id);

-- Ø¬Ø¯ÙˆÙ„ subjects Ø¨Ø±Ø§ÛŒ Ø¬Ø³ØªØ¬ÙˆÛŒ Ø¯Ø±Ø®ØªÛŒ
CREATE INDEX idx_subjects_parent ON subjects(parent_id);
CREATE INDEX idx_subjects_company_code ON subjects(company_id, code);

-- Ø¬Ø¯ÙˆÙ„ documents
CREATE INDEX idx_documents_company_date ON documents(company_id, date);
CREATE INDEX idx_documents_number ON documents(number);

-- Ø¬Ø¯Ø§Ø³Ø§Ø²ÛŒ Ø´Ø±Ú©Øªâ€ŒÙ‡Ø§
CREATE INDEX idx_customers_company ON customers(company_id);
CREATE INDEX idx_products_company ON products(company_id);
```

## ğŸ”„ Ù…Ø§ÛŒÚ¯Ø±ÛŒØ´Ù†â€ŒÙ‡Ø§ Ùˆ Seeder Ù‡Ø§

### ØªØ±ØªÛŒØ¨ Ø§Ø¬Ø±Ø§ÛŒ Ù…Ø§ÛŒÚ¯Ø±ÛŒØ´Ù†â€ŒÙ‡Ø§

```bash
1. create_users_table
2. create_companies_table
3. create_fiscal_years_table
4. create_subjects_table
5. create_documents_table
6. create_transactions_table
7. create_customers_table
8. create_products_table
9. create_invoices_table
10. create_invoice_items_table
# Ùˆ Ø¨Ù‚ÛŒÙ‡ Ø¬Ø¯Ø§ÙˆÙ„...
```

### Seeder Ù‡Ø§ÛŒ Ø§ØµÙ„ÛŒ

```php
// DatabaseSeeder.php
public function run()
{
    $this->call([
        PermissionSeeder::class,    // Ù…Ø¬ÙˆØ²Ù‡Ø§ Ùˆ Ù†Ù‚Ø´â€ŒÙ‡Ø§
        CompanySeeder::class,       // Ø´Ø±Ú©Øª Ù¾ÛŒØ´â€ŒÙØ±Ø¶
        SubjectSeeder::class,       // Ø³Ø±ÙØµÙ„â€ŒÙ‡Ø§ÛŒ Ù¾Ø§ÛŒÙ‡
        UserSeeder::class,          // Ú©Ø§Ø±Ø¨Ø± Ù…Ø¯ÛŒØ±
        ConfigSeeder::class,        // ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾ÛŒØ´â€ŒÙØ±Ø¶
    ]);
}
```

### Ù†Ù…ÙˆÙ†Ù‡ Seeder Ø¨Ø±Ø§ÛŒ Ø³Ø±ÙØµÙ„â€ŒÙ‡Ø§

```php
// SubjectSeeder.php
public function run()
{
    $company = Company::first();
    
    // Ø¯Ø§Ø±Ø§ÛŒÛŒâ€ŒÙ‡Ø§
    $assets = Subject::create([
        'code' => '1',
        'name' => 'Ø¯Ø§Ø±Ø§ÛŒÛŒâ€ŒÙ‡Ø§',
        'company_id' => $company->id,
        'type' => 'debtor'
    ]);
    
    // Ø¯Ø§Ø±Ø§ÛŒÛŒâ€ŒÙ‡Ø§ÛŒ Ø¬Ø§Ø±ÛŒ
    $currentAssets = Subject::create([
        'code' => '1.1',
        'name' => 'Ø¯Ø§Ø±Ø§ÛŒÛŒâ€ŒÙ‡Ø§ÛŒ Ø¬Ø§Ø±ÛŒ', 
        'parent_id' => $assets->id,
        'company_id' => $company->id,
        'type' => 'debtor'
    ]);
    
    // Ù†Ù‚Ø¯ Ùˆ Ø¨Ø§Ù†Ú©
    Subject::create([
        'code' => '1.1.1',
        'name' => 'Ù†Ù‚Ø¯ Ùˆ Ø¨Ø§Ù†Ú©',
        'parent_id' => $currentAssets->id,
        'company_id' => $company->id,
        'type' => 'debtor'
    ]);
}
```

## ğŸ”’ Ø§Ù…Ù†ÛŒØª Ø¯ÛŒØªØ§Ø¨ÛŒØ³

### Ú©Ù†ØªØ±Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ

```php
// in Model Ù‡Ø§ Ù‡Ù…ÛŒØ´Ù‡ ÙÛŒÙ„ØªØ± Ø´Ø±Ú©Øª Ø§Ø¹Ù…Ø§Ù„ Ø´ÙˆØ¯
class Document extends Model
{
    protected static function booted()
    {
        static::addGlobalScope('company', function (Builder $builder) {
            if (session('active-company-id')) {
                $builder->where('company_id', session('active-company-id'));
            }
        });
    }
}
```


### Audit Trail

```php
// Ø±Ø¯Ú¯ÛŒØ±ÛŒ ØªØºÛŒÛŒØ±Ø§Øª
Schema::create('audit_logs', function (Blueprint $table) {
    $table->id();
    $table->string('table_name');
    $table->bigInteger('record_id');
    $table->json('old_values')->nullable();
    $table->json('new_values')->nullable();
    $table->string('action'); // create, update, delete
    $table->foreignId('user_id');
    $table->timestamp('created_at');
});
```
